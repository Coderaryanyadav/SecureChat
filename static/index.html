<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SecureChat - End-to-End Encrypted Messaging</title>
    <link rel="stylesheet" href="/static/style.css">
    <meta name="description" content="Secure, private, end-to-end encrypted messaging">
</head>

<body data-theme="dark">
    <!-- Ultra-Premium Background Elements -->
    <div
        style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none; background: radial-gradient(circle at 10% 10%, #001a33 0%, #010101 40%); opacity: 0.8;">
    </div>
    <div
        style="position: fixed; top: -50%; left: -50%; width: 200%; height: 200%; z-index: -1; pointer-events: none; background: url('data:image/svg+xml,%3Csvg viewBox=\'0 0 200 200\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cfilter id=\'noiseFilter\'%3E%3CfeTurbulence type=\'fractalNoise\' baseFrequency=\'0.85\' numOctaves=\'4\' stitchTiles=\'stitch\'/%3E%3C/filter%3E%3Crect width=\'100%25\' height=\'100%25\' filter=\'url(%23noiseFilter)\'/%3E%3C/svg%3E'); opacity: 0.05;">
    </div>

    <!-- Login Screen -->
    <div id="login-screen" class="auth-container">
        <div class="auth-card">
            <div class="auth-header">
                <h1>SecureChat</h1>
                <p>Private. Encrypted. Invisible.</p>
            </div>

            <div id="login-form">
                <div class="form-group">
                    <label for="login-username">Username</label>
                    <input type="text" id="login-username" placeholder="Enter your username" autocomplete="username">
                </div>

                <div class="form-group">
                    <label for="login-password">Password</label>
                    <input type="password" id="login-password" placeholder="Enter your password"
                        autocomplete="current-password">
                </div>

                <button id="login-btn" class="btn btn-primary">Log In</button>

                <div class="link-text">
                    Don't have an account? <a href="#" id="show-register">Sign up</a>
                </div>

                <div class="link-text" style="margin-top: 12px; opacity: 0.6;">
                    <a href="#" id="show-recover" style="font-size: 13px;">Lost your key? Recover account</a>
                </div>
            </div>

            <div id="register-form" class="hidden">
                <div class="form-group">
                    <label for="register-username">Choose Username</label>
                    <input type="text" id="register-username" placeholder="Enter username" autocomplete="username">
                </div>

                <div class="form-group">
                    <label for="register-password">Choose Password</label>
                    <input type="password" id="register-password" placeholder="Min 12 characters"
                        autocomplete="new-password">
                    <small style="color: var(--text-muted); font-size: 12px; margin-top: 4px; display: block;">
                        Must include uppercase, lowercase, number & special character
                    </small>
                </div>

                <button id="register-btn" class="btn btn-primary">Create Account</button>

                <div class="link-text">
                    Already have an account? <a href="#" id="show-login">Log in</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Recovery Modal -->
    <div id="recovery-modal" class="modal hidden">
        <div class="modal-content">
            <div id="recovery-key-display" class="hidden">
                <h2>Save Your Recovery Key</h2>
                <p>This is your ONLY way to recover your account if you forget your password. Save it somewhere safe!
                </p>
                <div class="recovery-key-box">
                    <code id="recovery-key-text"></code>
                </div>
                <button id="copy-recovery-key" class="btn btn-secondary">Copy Key</button>
                <button id="close-recovery" class="btn btn-primary">I've Saved It</button>
            </div>

            <div id="recovery-form" class="hidden">
                <h2>Recover Account</h2>
                <div class="form-group">
                    <label>Username</label>
                    <input type="text" id="recover-username">
                </div>
                <div class="form-group">
                    <label>Recovery Key</label>
                    <input type="text" id="recover-key">
                </div>
                <div class="form-group">
                    <label>New Password</label>
                    <input type="password" id="recover-password">
                </div>
                <button id="recover-btn" class="btn btn-primary">Recover Account</button>
                <button id="cancel-recover" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Main Chat Interface -->
    <div id="chat-screen" class="chat-layout hidden">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>Chats</h2>
                <div class="header-actions">
                    <button id="theme-toggle" class="icon-btn" title="Toggle theme">üåì</button>
                    <button id="settings-btn" class="icon-btn" title="Settings">‚öôÔ∏è</button>
                </div>
            </div>

            <div class="search-bar">
                <input type="text" id="search-input" class="search-input" placeholder="Search chats...">
            </div>

            <div id="chat-list" class="chat-list">
                <!-- Chat items will be added here dynamically -->
            </div>

            <div style="padding: 16px; border-top: 1px solid var(--border);">
                <button id="new-chat-btn" class="btn btn-primary">New Chat</button>
            </div>
        </div>

        <!-- Chat Area -->
        <div class="chat-area">
            <div class="chat-header">
                <div class="chat-header-left">
                    <button id="back-btn" class="icon-btn">‚Üê</button>
                    <div class="avatar" id="chat-avatar">?</div>
                    <div class="chat-header-info">
                        <h3 id="chat-name">Select a chat</h3>
                        <div id="chat-status" class="chat-header-status">Offline</div>
                    </div>
                </div>
                <div class="header-actions">
                    <button id="search-chat-btn" class="icon-btn" title="Search">üîç</button>
                    <button id="chat-menu-btn" class="icon-btn" title="Menu">‚ãÆ</button>
                </div>
            </div>

            <div id="messages-container" class="messages-container">
                <!-- Messages will be added here -->
            </div>

            <div id="reply-preview" class="hidden"
                style="padding: 12px 20px; background: var(--bg-primary); border-top: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center;">
                <div style="flex: 1;">
                    <div style="font-size: 12px; color: var(--primary); font-weight: 600; margin-bottom: 2px;">Replying
                        to <span id="reply-to-user"></span></div>
                    <div id="reply-preview-text"
                        style="font-size: 13px; color: var(--text-secondary); overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                    </div>
                </div>
                <button id="cancel-reply" class="icon-btn">‚úï</button>
            </div>

            <div id="typing-indicator" class="hidden"
                style="padding: 8px 20px; background: var(--bg-primary); border-top: 1px solid var(--border);">
                <span style="font-size: 13px; color: var(--text-secondary);"><span id="typing-user"></span> is
                    typing...</span>
            </div>

            <div class="input-area">
                <div class="input-container">
                    <button id="attach-btn" class="icon-btn" title="Attach file">üìé</button>
                    <input type="file" id="file-input" class="hidden" accept="image/*,video/*">
                    <textarea id="message-input" class="input-field" placeholder="Type a message..."
                        rows="1"></textarea>
                    <button id="send-btn" class="send-btn" title="Send">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- New Chat Modal -->
    <div id="new-chat-modal" class="modal hidden">
        <div class="modal-content">
            <h2>Join Room</h2>
            <div class="form-group">
                <label>Room ID</label>
                <input type="text" id="room-id-input" placeholder="Enter room ID">
                <button id="generate-room-id" class="btn btn-secondary" style="margin-top: 8px;">Generate Random
                    ID</button>
            </div>
            <div class="form-group">
                <label>Room Password</label>
                <input type="password" id="room-password-input" placeholder="Encryption password (min 8 chars)">
            </div>
            <button id="join-room-btn" class="btn btn-primary">Join Room</button>
            <button id="cancel-new-chat" class="btn btn-secondary">Cancel</button>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal hidden">
        <div class="modal-content">
            <h2>Settings</h2>
            <div style="display: flex; flex-direction: column; gap: 16px; margin: 24px 0;">
                <div>
                    <h3 style="font-size: 14px; font-weight: 600; margin-bottom: 8px;">Account</h3>
                    <button id="export-data-btn" class="btn btn-secondary">Export My Data</button>
                    <button id="delete-account-btn" class="btn"
                        style="background: #dc2626; color: white; margin-top: 8px;">Delete Account</button>
                </div>
                <div>
                    <h3 style="font-size: 14px; font-weight: 600; margin-bottom: 8px;">About</h3>
                    <p style="font-size: 13px; color: var(--text-secondary);">SecureChat v2.0</p>
                    <p style="font-size: 13px; color: var(--text-secondary);">End-to-end encrypted messaging</p>
                </div>
            </div>
            <button id="close-settings" class="btn btn-primary">Close</button>
            <button id="logout-btn" class="btn btn-secondary">Log Out</button>
        </div>
    </div>

    <div id="offline-indicator" class="hidden"
        style="position: fixed; top: 0; left: 0; right: 0; background: #dc2626; color: white; text-align: center; padding: 8px; font-size: 13px; z-index: 1000;">
        ‚ö†Ô∏è No internet connection
    </div>

    <script src="/static/script.js"></script>
</body>

</html>